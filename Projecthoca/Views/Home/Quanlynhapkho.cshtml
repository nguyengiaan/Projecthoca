@{
    Layout = "_Layout";
}
@model Projecthoca.Models.EnitityVM.DanhmucVM
<style>
    .container {
        display: flex;
        justify-content: space-between;
        /* Căn chỉnh các phần tử nằm kế bên nhau */
    }


    .form-container {
        flex: 1;
        padding-right: 20px;
        /* Khoảng cách giữa phần tử form và danh sách */
    }

    .form-group {
        margin-bottom: 15px;
    }

    .form-group label {
        display: block;
        margin-bottom: 5px;
    }

    .form-group input {
        width: 100%;
        /* Đảm bảo ô input rộng đầy */
        padding: 8px;
        box-sizing: border-box;
    }

    .form-group1 {
        flex: 1;
        padding-left: 20px;

    }

    .search-container {
        margin-bottom: 15px;
    }

    .search-container input {
        width: 100%;
        /* Đảm bảo ô input tìm kiếm rộng đầy */
        padding: 8px;
        box-sizing: border-box;
    }

    .table-container {
        margin-top: 15px;
    }

    .table-container table {
        width: 100%;
        /* Đảm bảo bảng rộng đầy */
        border-collapse: collapse;
    }

    .table-container th,
    .table-container td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
    }

    .table-container th {
        background-color: #f2f2f2;
    }

    /* Nút chính */
    #submitBtnpn {
        background-color: #007bff;
        /* Màu nền chính */
        color: white;
        /* Màu chữ */
        border: none;
        /* Không viền */
        padding: 10px 20px;
        /* Khoảng cách bên trong */
        font-size: 16px;
        /* Kích thước chữ */
        border-radius: 5px;
        /* Bo góc */
        cursor: pointer;
        /* Con trỏ khi di chuột qua */
        transition: background-color 0.3s ease, transform 0.2s ease;
        /* Hiệu ứng chuyển màu và phóng to */
    }

    #submitBtnpn:hover {
        background-color: #0056b3;
        /* Màu nền khi di chuột qua */
        transform: scale(1.05);
        /* Phóng to nhẹ khi di chuột qua */
    }

    /* Nút phụ */
    #closeBtn {
        background-color: #6c757d;
        /* Màu nền phụ */
        color: white;
        /* Màu chữ */
        border: none;
        /* Không viền */
        padding: 10px 20px;
        /* Khoảng cách bên trong */
        font-size: 16px;
        /* Kích thước chữ */
        border-radius: 5px;
        /* Bo góc */
        cursor: pointer;
        /* Con trỏ khi di chuột qua */
        transition: background-color 0.3s ease, transform 0.2s ease;
        /* Hiệu ứng chuyển màu và phóng to */
    }

    #closeBtn:hover {
        background-color: #5a6268;
        /* Màu nền khi di chuột qua */
        transform: scale(1.05);
        /* Phóng to nhẹ khi di chuột qua */
    }
</style>

<div class="modal fade" id="Themphieunhap" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document" id="formtong" style="max-width: 90%;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Thêm phiếu nhập</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="form-container">
                        <form id="formnhapkho" enctype="multipart/form-data">
                            @* <div class="form-group">
                                <label for="Ma_danhmuc">Mã danh mục</label>
                                <input asp-for="Ma_danhmuc" type="text" id="Ma_danhmuc" readonly>
                            </div> *@
                            <div class="form-group position-relative">
                                <label for="Ten_danhmuc">Tên danh mục</label>
                                <input asp-for="Ten_danhmuc" type="text" id="Ten_danhmuc" oninput="filterDanhMucList()"
                                    placeholder="Nhập tên danh mục..." autocomplete="off">

                                <!-- Danh sách danh mục -->
                                <div id="danhMucList" class="dropdown-menu" style="display: none; width: 100%;">
                                    <table class="table table-hover">
                                        <tbody id="tblbody"></tbody>
                                    </table>
                                </div>
                            </div>


                            <div class="form-group">
                                <label for="Gia">Giá</label>
                                <input asp-for="Gia" type="text" id="Gia">
                            </div>
                            <div class="form-group">
                                <label for="Soluong">Số lượng</label>
                                <input type="number" id="Soluong">
                            </div>
                            <div class="form-group">
                                <label for="Donvitinh">Đơn vị tính</label>
                                <input asp-for="Donvitinh" type="text" id="Donvitinh">
                            </div>
                            <button type="button" id="btnThemVaoBangModal" class="btn btn-success">Thêm vào
                                bảng</button>
                        </form>

                    </div>
                    <div class="form-group1">
                        <div class="search-container">
                            <input type="text" id="TenSanPham" onkeyup="searchProduct()"
                                placeholder="Tìm kiếm sản phẩm...">
                        </div>
                        <div class="table-container">
                            <h5>Danh sách danh mục</h5>
                            <table>
                                <thead>
                                    <tr>
                                        @* <th>Mã danh mục</th> *@
                                        <th>Tên danh mục</th>
                                        <th>Đơn vị tính</th>
                                        <th>Số lượng</th>
                                        <th>Đơn giá</th>
                                        <th>Xóa</th>
                                        <th>Sửa</th>
                                    </tr>
                                </thead>
                                <tbody id="tblbodyModal">
                                    <!-- Dữ liệu sẽ được thêm vào đây bởi JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="submitBtnpn" class="btn btn-primary">Thêm phiếu nhập</button>

                <button type="button" data-dismiss="modal" id="closeBtn">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Danh sách Danh mục-->
<div class="container-fluid">
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <div class="row">
                <div class="col-md-10 col-12">
                    <h4 class="m-0 font-weight-bold text-primary">Danh sách phiếu nhập</h4>
                </div>
                <div class="col-md-2 col-12">
                    <button class="btn btn-primary" data-toggle="modal" data-target="#Themphieunhap">Thêm phiếu
                        nhập</button>
                </div>
            </div>
        </div>
        <!--Xem danh sách phiếu-->
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                    <thead>
                        <tr>
                            <th>Mã phiếu</th>
                            <th>Tên người nhập</th>
                            <th>Ngày nhập phiếu</th>
                            <th>Xem phiếu</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody">
                        <!-- Dữ liệu sẽ được thêm vào bảng tại đây -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<!-- Modal hiển thị chi tiết phiếu nhập -->
<div class="modal fade" id="ChiTietPhieuModal" tabindex="-1" role="dialog" aria-labelledby="ChiTietPhieuModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ChiTietPhieuModalLabel">Chi tiết phiếu nhập</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">

                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-bordered" id="chiTietTable" width="100%" cellspacing="0">
                        <thead>
                            <tr>
                                <th>Mã hàng</th>
                                <th>Tên hàng</th>
                                <th>Đơn vị tính</th>
                                <th>Số lượng</th>
                                <th>Đơn giá</th>
                            </tr>
                        </thead>
                        <tbody id="chiTietTableBody">
                            <!-- Dữ liệu chi tiết phiếu sẽ được thêm vào đây -->
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
 
            </div>
        </div>
    </div>
</div>
<!-- Modal chỉnh sửa phiếu nhập -->
<div class="modal fade" id="ChinhSuaPhieuModal" tabindex="-1" role="dialog" aria-labelledby="ChinhSuaPhieuModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ChinhSuaPhieuModalLabel">Chỉnh sửa chi tiết phiếu nhập</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="formChinhSuaPhieu">
                    <div class="form-group">
                        <label for="editMaHang">Mã hàng</label>
                        <input type="text" class="form-control" id="editMaHang" readonly>
                    </div>
                    <div class="form-group">
                        <label for="editTenHang">Tên hàng</label>
                        <input type="text" class="form-control" id="editTenHang">
                    </div>
                    <div class="form-group">
                        <label for="editDonViTinh">Đơn vị tính</label>
                        <input type="text" class="form-control" id="editDonViTinh">
                    </div>
                    <div class="form-group">
                        <label for="editSoLuong">Số lượng</label>
                        <input type="number" class="form-control" id="editSoLuong">
                    </div>
                    <div class="form-group">
                        <label for="editDonGia">Đơn giá</label>
                        <input type="number" class="form-control" id="editDonGia">
                    </div>
                    <div id="danhMucList" class="table-container">
                        <!-- Danh mục sẽ được nạp vào đây -->
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
                <button type="button" class="btn btn-primary" id="saveChanges">Lưu thay đổi</button>
            </div>
        </div>
    </div>
</div>


@section Scripts {
    <script>
        
        $(document).ready(function () {
            var phieuNhaps = []; // Mảng lưu trữ các phiếu nhập
            var editingPhieuIndex = -1; // Biến để lưu vị trí phiếu đang sửa

            // Hiển thị modal chỉnh sửa khi nhấn nút "Sửa"
            $(document).on('click', '.btnSuaPhieu', function () {
                var maPhieu = $(this).data('phieu');
                var phieu = phieuNhaps.find(p => p.maPhieu === maPhieu);

                // Hiển thị danh sách chi tiết phiếu trong modal chỉnh sửa
                $('#tblbodyModalEdit').empty();
                phieu.chiTietPhieu.forEach(function (item) {
                    var chiTietRow = `
                    <tr>
                        @* <td>${item.maHang}</td> *@
                        <td>${item.tenHang}</td>
                        <td>${item.donViTinh}</td>
                        <td>${item.soLuong}</td>
                        <td>${item.donGia}</td>
                        <td><button class="btn btn-danger btnXoaModalEdit">Xóa</button></td>
                        <td><button class="btn btn-warning btnSuaModalEdit">Sửa</button></td>
                    </tr>`;
                    $('#tblbodyModalEdit').append(chiTietRow);
                });

                // Hiển thị dữ liệu phiếu trong form chỉnh sửa
                $('#EditMaDanhmuc').val(phieu.maDanhMuc);
                $('#EditTenDanhmuc').val(phieu.tenDanhMuc);
                $('#EditGia').val(phieu.gia);
                $('#EditSoluong').val(phieu.soLuong);
                $('#EditDonvitinh').val(phieu.donViTinh);

                // Hiển thị modal chỉnh sửa phiếu nhập
                $('#ChinhSuaPhieuModal').modal('show');
                editingPhieuIndex = phieuNhaps.indexOf(phieu); // Lưu chỉ số phiếu đang sửa
            });

            // Cập nhật dữ liệu phiếu nhập khi nhấn nút "Cập nhật phiếu nhập"
            $('#btnCapNhatPhieu').click(function () {
                if (editingPhieuIndex === -1) return; // Nếu không có phiếu nào đang sửa

                // Cập nhật thông tin phiếu
                var updatedPhieu = {
                    maPhieu: $('#EditMaDanhmuc').val(),
                    tenNguoiNhap: "Tên người nhập", // Bạn có thể lấy từ input
                    ngayNhapPhieu: new Date().toLocaleDateString(), // Ngày hiện tại
                    chiTietPhieu: []
                };

                $('#tblbodyModalEdit tr').each(function () {
                    @* var maHang = $(this).find('td:eq(0)').text(); *@
                    var tenHang = $(this).find('td:eq(1)').text();
                    var donViTinh = $(this).find('td:eq(2)').text();
                    var soLuong = $(this).find('td:eq(3)').text();
                    var donGia = $(this).find('td:eq(4)').text();

                    updatedPhieu.chiTietPhieu.push({ maHang, tenHang, donViTinh, soLuong, donGia });
                });

                // Cập nhật dữ liệu phiếu trong mảng
                phieuNhaps[editingPhieuIndex] = updatedPhieu;

                // Cập nhật dữ liệu trong bảng ngoài
                var row = $('#dataTableBody').find(`button[data-phieu="${updatedPhieu.maPhieu}"]`).closest('tr');
                row.find('td:eq(1)').text(updatedPhieu.tenNguoiNhap);
                row.find('td:eq(2)').text(updatedPhieu.ngayNhapPhieu);

                // Đóng modal chỉnh sửa phiếu nhập
                $('#ChinhSuaPhieuModal').modal('hide');
            });

            // Xử lý sự kiện khi nhấn nút Xóa trong modal chỉnh sửa
            $(document).on('click', '.btnXoaModalEdit', function () {
                $(this).closest('tr').remove(); // Xóa dòng tương ứng
            });

            // Xử lý sự kiện khi nhấn nút Sửa trong modal chỉnh sửa
            $(document).on('click', '.btnSuaModalEdit', function () {
                var row = $(this).closest('tr');
                $('#EditMaDanhmuc').val(row.find('td:nth-child(1)').text());
                $('#EditTenDanhmuc').val(row.find('td:nth-child(2)').text());
                $('#EditDonvitinh').val(row.find('td:nth-child(3)').text());
                $('#EditSoluong').val(row.find('td:nth-child(4)').text());
                $('#EditGia').val(row.find('td:nth-child(5)').text());
            });

            // Hàm lọc danh mục trong modal chỉnh sửa
            function filterDanhMucListEdit() {
                var searchText = $('#EditTenDanhmuc').val().toLowerCase();
                $('#danhMucListEdit').empty();

                danhMucList.forEach(function (danhMuc) {
                    if (danhMuc.tenDanhMuc.toLowerCase().includes(searchText)) {
                        var item = `<a class="dropdown-item" href="#"  data-ten="${danhMuc.tenDanhMuc}">${danhMuc.tenDanhMuc}</a>`;
                        $('#danhMucListEdit').append(item);
                    }
                });

                $('#danhMucListEdit').show();
            }

            // Xử lý sự kiện khi nhấn vào danh mục trong danh sách danh mục
            $(document).on('click', '#danhMucListEdit .dropdown-item', function () {
                var maDanhMuc = $(this).data('ma');
                var tenDanhMuc = $(this).data('ten');

                $('#EditMaDanhmuc').val(maDanhMuc);
                $('#EditTenDanhmuc').val(tenDanhMuc);
                $('#danhMucListEdit').hide();
            });
        });


        // Hàm hiển thị danh sách danh mục
        function showDanhMucList() {
            var page = 1; // Có thể thêm phân trang nếu cần thiết
            var pagesize = 10;
            danhsachdanhmuc(page, pagesize);

            // Hiển thị dropdown danh sách
            $('#danhMucList').show();
        }

        // Ẩn danh sách khi nhấp ra ngoài
        $(document).click(function (event) {
            if (!$(event.target).closest('#Ten_danhmuc, #danhMucList').length) {
                $('#danhMucList').hide();
            }
        });

    // Hàm xử lý khi chọn một mục từ danh sách
function selectItem(ten_danhmuc, gia, soluong, donvitinh) {
    // Gán giá trị cho các input
    $('#Ten_danhmuc').val(ten_danhmuc);      // Gán tên danh mục
    $('#Gia').val(gia);                      // Gán giá
    $('#Soluong').val(soluong);              // Gán số lượng
    $('#Donvitinh').val(donvitinh);          // Gán đơn vị tính

    // Ẩn danh sách danh mục sau khi chọn
    $('#danhMucList').hide();
}



// Hàm lọc danh mục dựa trên ô input
function filterDanhMucList() {
    var searchText = $('#Ten_danhmuc').val().toLowerCase();
    var page = 1; // Có thể thêm phân trang nếu cần thiết
    var pagesize = 10;

    $.ajax({
        type: "POST",
        url: "/Quanlyhanghoa/GetAll",
        data: { page: page, pagesize: pagesize },
        success: function (response) {
            $('#tblbody').empty();
            if (response.success) {
                var filteredItems = response.dssp.filter(function (item) {
                    return item.ten_sanpham.toLowerCase().includes(searchText);
                });

                if (filteredItems.length > 0) {
                    $.each(filteredItems, function (index, value) {
                        var str = `
                        <tr onclick="selectItem('${value.ten_sanpham}', '${value.giaban}', '${value.ten_donvitinh}')">
                            <td>${value.ten_sanpham}</td>
                            <td>${value.ten_donvitinh}</td>
                           <td> ${value.giaban}</td>
                        </tr>`;
                        $('#tblbody').append(str);
                    });
                    $('#danhMucList').show();
                } else {
                    $('#danhMucList').hide();
                }

                updatePagination(response.totalPages, response.pageindex);
            } else {
                Swal.fire({
                    title: "Thông báo lỗi",
                    text: response.message,
                    icon: "error"
                });
            }
        }
    });
}

// Hàm lọc các mục danh mục dựa trên ô tìm kiếm
function filterTable() {
    var searchText = $('#Ten_danhmuc').val().toLowerCase();
    var rows = $('#tblbody tr');

    rows.each(function () {
        var cells = $(this).find('td');
        var match = false;

        cells.each(function () {
            if ($(this).text().toLowerCase().includes(searchText)) {
                match = true;
            }
        });

        $(this).toggle(match);
    });
}

// Thêm sự kiện keyup cho ô tìm kiếm
$('#Ten_danhmuc').on('keyup', function () {
    filterDanhMucList();
    filterTable();
});

       // Hàm xử lý khi chọn một mục từ danh sách
function selectItem(ten_danhmuc, gia, donvitinh) {
    // Gán giá trị cho các input
    $('#Ten_danhmuc').val(ten_danhmuc);      // Gán tên danh mục
    $('#Gia').val(gia);                      // Gán giá
            
    $('#Donvitinh').val(donvitinh);          // Gán đơn vị tính

    // Ẩn danh sách danh mục sau khi chọn
    $('#danhMucList').hide();
}


        // Ẩn danh sách khi nhấp ra ngoài
        $(document).click(function (event) {
            if (!$(event.target).closest('#Ten_danhmuc, #danhMucList').length) {
                $('#danhMucList').hide();
            }
        });



        $(document).ready(function () {
            var editingModalRowIndex = -1; // Biến để lưu vị trí dòng đang sửa trong modal

            // Hàm thêm dữ liệu vào bảng trong modal
            $('#btnThemVaoBangModal').click(function () {
                @* var maDanhMuc = $('#Ma_danhmuc').val(); *@
                var tenDanhMuc = $('#Ten_danhmuc').val();
                var gia = $('#Gia').val();
                var soLuong = $('#Soluong').val();
                var donViTinh = $('#Donvitinh').val();

                if (editingModalRowIndex === -1) {
                    // Thêm mới vào bảng nếu không có dòng nào đang sửa
                    var newRow = `
                    <tr>
                        @* <td>${maDanhMuc}</td> *@
                        <td>${tenDanhMuc}</td>
                        <td>${donViTinh}</td>
                        <td>${soLuong}</td>
                        <td>${gia}</td>
                        <td><button class="btn btn-danger btnXoaModal">Xóa</button></td>
                        <td><button class="btn btn-warning btnSuaModal">Sửa</button></td>
                    </tr>`;
                    $('#tblbodyModal').append(newRow);
                } else {
                    // Cập nhật dữ liệu dòng đang sửa trong modal
                    var editingRow = $('#tblbodyModal tr').eq(editingModalRowIndex);
                    @* editingRow.find('td:nth-child(1)').text(maDanhMuc); *@
                    editingRow.find('td:nth-child(2)').text(tenDanhMuc);
                    editingRow.find('td:nth-child(3)').text(donViTinh);
                    editingRow.find('td:nth-child(4)').text(soLuong);
                    editingRow.find('td:nth-child(5)').text(gia);
                    editingModalRowIndex = -1;
                }

                // Reset form sau khi thêm hoặc sửa
                $('#formnhapkho')[0].reset();
            });

            // Hàm xử lý khi nhấn nút Xóa trong modal
            $(document).on('click', '.btnXoaModal', function () {
                $(this).closest('tr').remove(); // Xóa dòng tương ứng
            });

            // Hàm xử lý khi nhấn nút Sửa trong modal
            $(document).on('click', '.btnSuaModal', function () {
                var row = $(this).closest('tr');
                editingModalRowIndex = row.index(); // Lưu vị trí dòng đang sửa

                // Đổ dữ liệu từ dòng vào form để sửa
                @* $('#Ma_danhmuc').val(row.find('td:nth-child(1)').text()); *@
                $('#Ten_danhmuc').val(row.find('td:nth-child(1)').text());
                $('#Donvitinh').val(row.find('td:nth-child(2)').text());
                $('#Soluong').val(row.find('td:nth-child(3)').text());
                $('#Gia').val(row.find('td:nth-child(4)').text());
            });
            $(document).ready(function () {
                // Mảng lưu trữ các phiếu nhập
                var phieuNhaps = [];

                // Hàm xử lý khi nhấn nút Thêm phiếu nhập
                $('#submitBtnpn').click(function () {
                    // Kiểm tra số lượng hàng trong bảng chi tiết của modal
                    var rowCount = $('#tblbodyModal tr').length;

                    if (rowCount === 0) {
                        // Nếu bảng không có hàng nào, hiện thông báo
                        Swal.fire({
                            title: 'Chưa thêm dữ liệu',
                            text: 'Danh sách phiếu nhập trống. Vui lòng thêm dữ liệu vào bảng trước khi thêm phiếu nhập.',
                            icon: 'warning',
                            confirmButtonText: 'OK'
                        });
                        return; // Dừng hàm và không thực hiện thêm phiếu nhập
                    }

                    var maPhieu = generateMaPhieu(); // Tạo mã phiếu ngẫu nhiên
                    var tenNguoiNhap = "Tên người nhập"; // Bạn có thể lấy từ input
                    var ngayNhapPhieu = new Date().toLocaleDateString(); // Ngày hiện tại

                    // Lấy danh sách chi tiết phiếu từ modal thêm phiếu nhập
                    var chiTietPhieu = [];
                    $('#tblbodyModal tr').each(function () {
                        var maHang = $(this).find('td:eq(0)').text();
                        var tenHang = $(this).find('td:eq(1)').text();
                        var donViTinh = $(this).find('td:eq(2)').text();
                        var soLuong = $(this).find('td:eq(4)').text();
                        var donGia = $(this).find('td:eq(3)').text();

                        chiTietPhieu.push({ maHang, tenHang, donViTinh, soLuong, donGia });
                    });

                    // Lưu phiếu nhập vào mảng
                    phieuNhaps.push({ maPhieu, tenNguoiNhap, ngayNhapPhieu, chiTietPhieu });

                    // Thêm dữ liệu vào bảng ngoài
                    var newRow = `
            <tr>
                <td>${maPhieu}</td>
                <td>${tenNguoiNhap}</td>
                <td>${ngayNhapPhieu}</td>
                <td><button class="btn btn-info btnXemPhieu" data-phieu="${maPhieu}">Xem phiếu</button></td>
            </tr>`;
                    $('#dataTableBody').append(newRow);

                    // Reset form trong modal sau khi thêm
                    $('#formnhapkho')[0].reset();
                    $('#tblbodyModal').empty(); // Xóa các hàng trong bảng chi tiết
                    $('#Themphieunhap').modal('hide'); // Đóng modal thêm phiếu nhập
                });

                // Xử lý sự kiện khi nhấn nút Xem phiếu
                $(document).on('click', '.btnXemPhieu', function () {
                    var maPhieu = $(this).data('phieu');
                    var phieu = phieuNhaps.find(p => p.maPhieu === maPhieu);

                    // Hiển thị danh sách chi tiết phiếu trong modal
                    $('#chiTietTableBody').empty(); // Xóa dữ liệu cũ
                    phieu.chiTietPhieu.forEach(function (item) {
                        var chiTietRow = `
                    <tr>
                        <td>${item.maHang}</td>
                        <td>${item.tenHang}</td>
                        <td>${item.donViTinh}</td>
                        <td>${item.soLuong}</td>
                        <td>${item.donGia}</td>

                    </tr>`;
                        $('#chiTietTableBody').append(chiTietRow);
                    });

                    // Hiển thị modal chi tiết phiếu nhập
                    $('#ChiTietPhieuModal').modal('show');
                });
            });

            function generateMaPhieu() {
                return 'PN' + Math.floor(Math.random() * 10000); // Tạo mã phiếu ngẫu nhiên
            }

            danhsachdanhmuc(1, 10);
        });


    </script>
}
